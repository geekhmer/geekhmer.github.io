<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ruby | GeeKhmer]]></title>
  <link href="http://geekhmer.github.io/blog/categories/ruby/atom.xml" rel="self"/>
  <link href="http://geekhmer.github.io/"/>
  <updated>2015-05-05T16:42:20+07:00</updated>
  <id>http://geekhmer.github.io/</id>
  <author>
    <name><![CDATA[Bunlong Van]]></name>
    <email><![CDATA[bunlong.van@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Preload Active Record Associations in Rails Application]]></title>
    <link href="http://geekhmer.github.io/blog/2015/05/05/preload-active-record-associations-in-rails-application/"/>
    <updated>2015-05-05T16:26:00+07:00</updated>
    <id>http://geekhmer.github.io/blog/2015/05/05/preload-active-record-associations-in-rails-application</id>
    <content type="html"><![CDATA[<p>
  <img src="http://geekhmer.github.io/images/happy_ruby_on_rails.jpg" width="400" alt="Preload Active Record Associations in Rails Application" />
</p>




<p>
  Active Record makes database querying so simple. Chain together a few methods and bam, you’ve saved your self lines and lines of T-SQL. The problem is this simplicity masks the underlying operation and it’s very easy to not realize how inefficient your database calls are.
</p>




<p>
  For example:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">User</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:posts</span>
</span><span class='line'><span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;class Post &amp;lt; ActiveRecord::Base</span>
</span><span class='line'><span class="sr">  has_many :comments</span>
</span><span class='line'><span class="sr">  belongs_to :user</span>
</span><span class='line'><span class="sr">end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="k">class</span> <span class="nc">Comment</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:post</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Let’s say on a users profile page we would like to show a listing of comments from this user.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;@user.posts.each do |post|</span>
</span><span class='line'><span class="sr">   post.comments.each do |comment|&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">%=</span> <span class="n">comment</span><span class="o">.</span><span class="n">message</span> <span class="o">%&amp;</span><span class="n">gt</span><span class="p">;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>   <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  What you end up with is something like:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">User</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">users</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;em&gt; FROM &lt;code&gt;users&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="nb">id</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="o">=</span> <span class="mi">1</span> <span class="no">LIMIT</span> <span class="mi">1</span>
</span><span class='line'> <span class="no">Post</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">7</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">posts</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;/em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">blogs</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;blogs&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">user_id</span><span class="o">&lt;</span><span class="sr">/code&gt; = 2</span>
</span><span class='line'><span class="sr"> Comment Load (0.7ms)  SELECT &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">post_id</span><span class="o">&lt;</span><span class="sr">/code&gt; = 43</span>
</span><span class='line'><span class="sr"> Comment Load (1.7ms)  SELECT &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;</span><span class="sr">/em&gt; FROM &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;code&gt;post_id&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="o">=</span> <span class="mi">55</span>
</span><span class='line'> <span class="no">Comment</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">2</span><span class="o">.</span><span class="mi">2</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;em&gt; FROM &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;code&gt;post_id&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="o">=</span> <span class="mi">32</span>
</span><span class='line'> <span class="no">Comment</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">9</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;/em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">post_id</span><span class="o">&lt;</span><span class="sr">/code&gt; = 66</span>
</span><span class='line'><span class="sr"> Comment Load (2.2ms)  SELECT &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">post_id</span><span class="o">&lt;</span><span class="sr">/code&gt; = 56</span>
</span><span class='line'><span class="sr"> Comment Load (4.8ms)  SELECT &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;</span><span class="sr">/em&gt; FROM &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;code&gt;post_id&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="o">=</span> <span class="mi">65</span>
</span><span class='line'> <span class="no">Comment</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">8</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;em&gt; FROM &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;code&gt;post_id&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="o">=</span> <span class="mi">68</span>
</span><span class='line'> <span class="no">Comment</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">8</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;/em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">post_id</span><span class="o">&lt;</span><span class="sr">/code&gt; = 71</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  The user has commented in 9 different posts, which results in 9 separate queries to the DB. This is a small scale example, but you can see how this can compound into something nasty.
</p>




<p>
  he solution is to user includes method:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="vi">@user</span> <span class="o">=</span> <span class="no">User</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span><span class="o">.</span><span class="n">includes</span><span class="p">(</span><span class="ss">:posts</span> <span class="o">=&gt;</span> <span class="ss">:comments</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  When using includes method, Active Record ensures that all of the specified associations are loaded using the minimum possible number of queries. The actual query executed is converted into a more optimal singular query and it is that result set that is iterated over instead of the replicated find(id) style queries.
</p>




<p>
  Our query stack list now looks like:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">User</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">users</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;em&gt; FROM &lt;code&gt;users&lt;/</span><span class="n">code</span><span class="o">&gt;</span> <span class="no">WHERE</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="nb">id</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="o">=</span> <span class="mi">1</span> <span class="no">LIMIT</span> <span class="mi">1</span>
</span><span class='line'><span class="no">Post</span> <span class="no">Load</span> <span class="p">(</span><span class="mi">0</span><span class="o">.</span><span class="mi">4</span><span class="n">ms</span><span class="p">)</span>  <span class="no">SELECT</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">posts</span><span class="o">&lt;</span><span class="sr">/code&gt;.&lt;/em</span><span class="o">&gt;</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">posts</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;posts&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">user_id</span><span class="o">&lt;</span><span class="sr">/code&gt; IN (1)</span>
</span><span class='line'><span class="sr">Comment Load (0.5ms)  SELECT &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">*</span> <span class="no">FROM</span> <span class="o">&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">comments</span><span class="o">&lt;</span><span class="sr">/code&gt; WHERE &lt;code&gt;comments&lt;/</span><span class="n">code</span><span class="o">&gt;.</span><span class="n">&lt;code</span><span class="o">&gt;</span><span class="n">post_id</span><span class="o">&lt;</span><span class="sr">/code&gt; IN (43, 55, 32, 66, 56, 65, 68, 71)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  So far so good, That's it!!! See ya!!! :)
</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Where Does Your Code Go in Rails Application?]]></title>
    <link href="http://geekhmer.github.io/blog/2015/05/05/where-does-your-code-go-in-rails-application/"/>
    <updated>2015-05-05T08:50:00+07:00</updated>
    <id>http://geekhmer.github.io/blog/2015/05/05/where-does-your-code-go-in-rails-application</id>
    <content type="html"><![CDATA[<p>
  <img src="http://geekhmer.github.io/images/ruby_on_rails.png" width="400" alt="Where Does Your Code Go in Rails Application?" />
</p>




<p>
  After you finish the Rails tutorials and start your own app, things get confusing something like where does your non-CRUD and general logic go?
</p>




<p>
  You can't build the app you've been dreaming of without some general, non-Rails logic. So where do you put your code, and still keep things simple?
</p>




<p>
  <strong>The Easy Place to Start</strong><br/>
  when I have logic that feels related to an existing ActiveRecord model, I'll start by putting it into that model. For example if I had a Game model and I want to import a bunch of games from CSV files, I would put that method right onto the Game class.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/models/game.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Game</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">parse_from_csv</span><span class="p">(</span><span class="n">csv_string</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;games = []</span>
</span><span class='line'><span class="sr">CSV.parse(csv_string, quote_char: &quot;&#39;&quot;) do |row|</span>
</span><span class='line'><span class="sr">  games &amp;lt;&amp;lt; Game.from_csv_row(row) if (row[0] == &#39;G&#39;)</span>
</span><span class='line'><span class="sr">end</span>
</span><span class='line'><span class="sr">games</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">from_csv_row</span><span class="p">(</span><span class="n">row</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;Game.new({</span>
</span><span class='line'><span class="sr">  dgs_game_id: row[1],</span>
</span><span class='line'><span class="sr">  opponent_name: row[2],</span>
</span><span class='line'><span class="sr">  created_at: row[4],</span>
</span><span class='line'><span class="sr">  updated_at: row[4],</span>
</span><span class='line'><span class="sr">})</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  You have all the information your methods need right at hand. it's easily testable. And it's probably where a new contributor world look for that logic first.
</p>




<p>
  But if you keep adding and changing that model, it'll get big and complicated. Different parts of the model will interact in strange ways. The more you change it, the harder it will be to change.
</p>




<p>
  In that case, you would probably want to refactor that code out to a non-ActiveRecord model.
</p>




<p>
  <strong>Non-ActiveRecord Models</strong><br/>
  You can write your own Ruby code, in plain Ruby objects, and use them in your Rails app. These objects can still be called models, because they're modeling part of your problem. They just don't have an ActiveRecord database storing their data.
</p>




<p>
  The next time I worked on that game CSV parser, the Game class was getting a little too big. So I moved the parser logic into its own GameCSVParser class.
</p>




<p>
  Non-ActiveRecord class looks like:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/models/game_csv_parser.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">GameCSVParser</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">csv_string</span><span class="p">)</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;@rows = CSV.parse(csv_string, quote_char: &quot;&#39;&quot;)</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">def</span> <span class="nf">games</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;game_rows.map { |row| Game.new(game_attributes(row)) }</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="kp">private</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def game_rows&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="vi">@rows</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">row</span><span class="o">|</span> <span class="n">is_game_row?</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="p">}</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def game_attributes(row)&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="p">{</span>
</span><span class='line'>  <span class="n">dgs_game_id</span><span class="p">:</span> <span class="n">row</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>  <span class="n">opponent_name</span><span class="p">:</span> <span class="n">row</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>  <span class="n">created_at</span><span class="p">:</span> <span class="n">row</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'>  <span class="n">updated_at</span><span class="p">:</span> <span class="n">row</span><span class="o">[</span><span class="mi">4</span><span class="o">]</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  def is_game_row?(row)&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">row</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span> <span class="o">==</span> <span class="s1">&#39;G&#39;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  I will go right to creating a new plain Ruby object if the logic I'm adding doesn't feel related to any specific ActiveRecord model. Of if the code seems like it should be a part of a thing that doesn't exist yet in the app. Otherwise, they mostly pop up through refactoring.
</p>




<p>
  So far so good, That's it!!! See ya!!! :)
</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby on Rails Charting with Chartkick Gem]]></title>
    <link href="http://geekhmer.github.io/blog/2015/05/02/ruby-on-rails-charting-with-chartkick-gem/"/>
    <updated>2015-05-02T20:30:00+07:00</updated>
    <id>http://geekhmer.github.io/blog/2015/05/02/ruby-on-rails-charting-with-chartkick-gem</id>
    <content type="html"><![CDATA[<p>
  <img src="http://geekhmer.github.io/images/chartkick.png" alt="Ruby on Rails Charting with Chartkick Gem" />
</p>




<p>
  Chartkick is a charting library for Ruby on Rails that allows you to easily create nice looking charts. Chartkick is compatible with all major browsers and can easily be used to give your Ruby on Rails application some additional flair. In this article we will cover the basics of using Chartkick.
</p>




<p>
  <strong>Rails Application Setup</strong><br/>
  Before we can use Chartkick, we will need to add it to our Gemfile. Open up your Gemfile and add the following code.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Gemfile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">chartkick</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">~&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">.</span><span class="mi">4</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  In addition, let's include a couple of helper gems that will make life easier when dealing with data. Add the following gems to your Gemfile.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Gemfile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">groupdate</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">~&gt;</span> <span class="mi">2</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span><span class='line'><span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">active_median</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">~&gt;</span> <span class="mi">0</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now let's run a bundle install to install all three gems.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bundle</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now we need to create a model that we will use with our charts. For this example app we will create a simple model called Visit. This model will represent a single user's 'visit' to a website. Run the command below to create this model now.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Visit</span> <span class="ss">country</span><span class="p">:</span><span class="n">string</span> <span class="n">visited_at</span><span class="ss">:datetime</span> <span class="n">load_time</span><span class="ss">:decimal</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now let's run a rake db:migrate to create the table associated with this model.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">migrate</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now we need to add some data to our seeds file in order to give us some data to play with. Open up your seeds.rb file and add in the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>db/seeds.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">delete_all</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">United</span> <span class="no">States</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">Germany</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">2</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">2</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">2</span><span class="o">.</span><span class="mi">5</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">1</span><span class="o">.</span><span class="n">day</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">3</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">2</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">1</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">4</span><span class="o">.</span><span class="mi">0</span>
</span><span class='line'><span class="no">Visit</span><span class="o">.</span><span class="n">create</span>  <span class="ss">country</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="no">South</span> <span class="no">Korea</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="n">visited_at</span><span class="p">:</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span> <span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span> <span class="mi">3</span><span class="o">.</span><span class="n">days</span><span class="p">,</span> <span class="n">load_time</span><span class="p">:</span> <span class="mi">5</span><span class="o">.</span><span class="mi">0</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now let's run a rake db:seed to seed our database.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">seed</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now let's create a controller to give us a place to play around. Run the commands below to create the Homes controller.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">homes</span> <span class="n">show</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now open up your routes file and add in the route listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Rails</span><span class="o">.</span><span class="n">application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">root</span> <span class="ss">to</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">homes</span><span class="c1">#show&amp;rdquo;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Next, open up your homes controller and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/controllers/homes_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">HomesController</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;@visits = Visit.all</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Finally, we need to modify our application layout. Open up your application's layout and modify it so that it looks like the following code. Note the inclusion of the Google API javascript file below. Chartkick can use either Google Charts or Highcharts for charting. In this example we use Google Charts. We also utilize Bootstrap for a cleaner look and feel.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/layouts/application.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">!</span><span class="no">DOCTYPE</span> <span class="n">html</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="no">ChartKickExample</span><span class="o">&lt;</span><span class="sr">/title&gt;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="sx">%= stylesheet_link_tag    &amp;lsquo;application&amp;rsquo;, media: &amp;lsquo;all&amp;rsquo; %&gt;</span>
</span><span class='line'><span class="sx">  &amp;lt;%=</span> <span class="n">javascript_include_tag</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">application</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &amp;lt;%= javascript_include_tag &amp;ldquo;&lt;a href=&quot;http://www.google.com/jsapi&quot;&gt;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="n">www</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">jsapi</span><span class="o">&lt;</span><span class="sr">/a&gt;&amp;rdquo;, &amp;ldquo;chartkick&amp;rdquo; %&gt;</span>
</span><span class='line'><span class="sr">  &amp;lt;%= stylesheet_link_tag &amp;lsquo;&lt;a href=&quot;http:/</span><span class="o">/</span><span class="n">yandex</span><span class="o">.</span><span class="n">st</span><span class="o">/</span><span class="n">bootstrap</span><span class="o">/</span><span class="mi">3</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">css</span><span class="o">/</span><span class="n">bootstrap</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">css</span><span class="s2">&quot;&gt;http://yandex.st/bootstrap/3.1.1/css/bootstrap.min.css&lt;/a&gt;&amp;rsquo; %&gt;</span>
</span><span class='line'><span class="s2">  &amp;lt;%= javascript_include_tag &amp;lsquo;&lt;a href=&quot;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="n">yandex</span><span class="o">.</span><span class="n">st</span><span class="o">/</span><span class="n">bootstrap</span><span class="o">/</span><span class="mi">3</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">/</span><span class="n">js</span><span class="o">/</span><span class="n">bootstrap</span><span class="o">.</span><span class="n">min</span><span class="o">.</span><span class="n">js</span><span class="s2">&quot;&gt;http://yandex.st/bootstrap/3.1.1/js/bootstrap.min.js&lt;/a&gt;&amp;rsquo; %&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;  &amp;lt;%= csrf_meta_tags %&gt;</span>
</span><span class='line'><span class="s2">&lt;/head&gt;</span>
</span><span class='line'><span class="s2">&lt;body&gt;</span>
</span><span class='line'><span class="s2">  &lt;div class=&quot;</span><span class="n">container</span><span class="s2">&quot;&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;pre&gt;&lt;code&gt;&amp;lt;%= yield %&amp;gt;</span>
</span><span class='line'><span class="s2">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;  &lt;/div&gt;</span>
</span><span class='line'><span class="s2">&lt;/body&gt;</span>
</span><span class='line'><span class="s2">&lt;/html&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  <strong>Line Charts</strong><br/>
  The first chart type we will work with is the line charts Line charts are handy for doing things like plotting out events over time. Open up your show view for the Homes controller and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'><span class="sr">  </span>
</span><span class='line'><span class="sr">  &lt;!-- Line Chart - Single Series --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Visits By Day&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;%=</span> <span class="n">line_chart</span> <span class="vi">@visits</span><span class="o">.</span><span class="n">group_by_day</span><span class="p">(</span><span class="ss">:visited_at</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="s2">&quot;%B %d, %Y&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">,</span> <span class="ss">discrete</span><span class="p">:</span> <span class="kp">true</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now if you start a <code>rails s</code> and navigate to http://localhost:3000 you will see a chart being rendered showing the number of vists by day.
</p>




<p>
  Great, now lets make a slightly more complex line chart. Open up the show view again and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;!-- Line Chart - Single Series --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Visits By Day&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= line_chart @visits.group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count, discrete: true %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;!-- Line Chart - Multiple Series --&gt;</span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Visits</span> <span class="no">By</span> <span class="no">Country</span> <span class="no">Per</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= line_chart   Visit.pluck(&quot;country&quot;).uniq.map { |c| { name: c, data: @visits.where(country: c).group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count }  }, discrete: true %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Refreshing the page results in a new line chart with multiple series listed. You see a line for each country with each point corresponding to the number of visits for that day.
</p>




<p>
  <strong>Pie Charts and Area Charts</strong><br/>
  We can also render a pie chart. Open up your show view again and append the following code to the end of the view.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Total Visits by Country&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;%=</span> <span class="n">pie_chart</span> <span class="vi">@visits</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="ss">:country</span><span class="p">)</span><span class="o">.</span><span class="n">count</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  If you refresh the page a pie chart will render with each slice representing the visits for that particular country. This information can also be represented via a geo chart. Modify your homes view to look like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;!-- Line Chart - Single Series --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Visits By Day&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= line_chart @visits.group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count, discrete: true %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;!-- Line Chart - Multiple Series --&gt;</span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Visits</span> <span class="no">By</span> <span class="no">Country</span> <span class="no">Per</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= line_chart   Visit.pluck(&quot;country&quot;).uniq.map { |c| { name: c, data: @visits.where(country: c).group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count }  }, discrete: true %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;!-- Pie Chart --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Total Visits by Country&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= pie_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;!-- Geo Chart --&gt; </span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Visits</span> <span class="no">By</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= geo_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Awesome! Now if you refresh the page, you'll notice a geo chart in the bottom right.
</p>




<p>
  <strong>Area Charts</strong><br/>
  You can also create an area chart. Add the code listed below to the end of your homes/show view.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;!-- area chart --&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;col-xs-12&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Total</span> <span class="no">Load</span> <span class="no">Time</span> <span class="no">By</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= area_chart @visits.group_by_day(:visited_at).maximum(:load_time) %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Great, now if you refresh the page you will see that the area chart has been added.
</p>




<p>
  <strong>Bar Charts and Column Charts</strong><br/>
  Both bar charts and column charts can be easily created. Modify your homes/show view so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;!-- Line Chart - Single Series --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Visits By Day&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= line_chart @visits.group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count, discrete: true %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;!-- Line Chart - Multiple Series --&gt;</span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Visits</span> <span class="no">By</span> <span class="no">Country</span> <span class="no">Per</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= line_chart   Visit.pluck(&quot;country&quot;).uniq.map { |c| { name: c, data: @visits.where(country: c).group_by_day(:visited_at, format: &quot;%B %d, %Y&quot;).count }  }, discrete: true %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">  &lt;!-- Pie Chart --&gt;</span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Total Visits by Country&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= pie_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sx">  &lt;!-- Geo Chart --&gt; </span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Visits</span> <span class="no">By</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= geo_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;!-- area chart --&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;row&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">div</span> <span class="n">class</span><span class="o">=</span><span class="s2">&quot;col-xs-12&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Total</span> <span class="no">Load</span> <span class="no">Time</span> <span class="no">By</span> <span class="no">Day</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= area_chart @visits.group_by_day(:visited_at).maximum(:load_time) %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;row&quot;&gt;</span>
</span><span class='line'><span class="sr">  &lt;!-- Column Chart --&gt; </span>
</span><span class='line'><span class="sr">  &lt;div class=&quot;col-xs-6&quot;&gt;</span>
</span><span class='line'><span class="sr">    &lt;h3&gt;Total Visits Per Country&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= column_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/div&gt;</span>
</span><span class='line'><span class="sx">  &lt;!-- Bar Chart --&gt; </span>
</span><span class='line'><span class="sx">  &lt;div class=</span><span class="s2">&quot;col-xs-6&quot;</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">h3</span><span class="o">&gt;</span><span class="no">Total</span> <span class="no">Visits</span> <span class="no">Per</span> <span class="no">Country</span><span class="o">&lt;</span><span class="sr">/h3&gt;</span>
</span><span class='line'><span class="sr">    &lt;%= bar_chart @visits.group(:country).count %&gt;</span>
</span><span class='line'><span class="sr">  &lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  If you refresh the page you'll see both column and bar charts at the bottom.
</p>




<p>
  <strong>Remote Charts</strong><br/>
  You can quickly and easily build remote AJAX driven charts. Let's create a simple series chart. First, we will create a new method on your homes controller called visits_by_day. Open up your homes controller and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/controllers/homes_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">HomesController</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;@visits = Visit.all</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">def</span> <span class="nf">visits_by_day</span>
</span><span class='line'>   <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="no">Visit</span><span class="o">.</span><span class="n">group_by_day</span><span class="p">(</span><span class="ss">:visited_at</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">%</span><span class="n">B</span> <span class="o">%</span><span class="n">d</span><span class="p">,</span> <span class="o">%</span><span class="n">Y</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;)</span><span class="o">.</span><span class="n">count</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Next, add in the code listed below to your homes/show view.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/homes/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;!-- Line Chart - Single Series --&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;div class=&quot;col-xs-12&quot;&gt;</span>
</span><span class='line'><span class="sr">  &lt;h3&gt;Visits By Day&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;%=</span> <span class="n">line_chart</span> <span class="n">visits_by_day_home_path</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/div&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  If you refresh the page, you'll notice that the new chart has been rendered. A quick look at your browser's developer console will show you that the visits_by_day data is pulled down via AJAX and then the site is rendered.
</p>




<p>
  <strong>Global Options</strong><br/>
  You can customize the global options for ChartKick. Create an initializer called chartkick.rb and add in the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/initializers/chartkick.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Chartkick</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">height</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="mi">300</span><span class="n">px</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span>
</span><span class='line'>  <span class="ss">colors</span><span class="p">:</span> <span class="o">[&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="c1">#ff0000&amp;rdquo;, &amp;ldquo;#00ff00&amp;rdquo;, &amp;ldquo;#0000ff&amp;rdquo;, &amp;ldquo;#ffff00&amp;rdquo;, &amp;ldquo;#ff00ff&amp;rdquo;, &amp;ldquo;0000ff&amp;rdquo;]</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  If you restart your Rails server and refresh the page, you will notice that the colors have changed.
</p>




<p>
  For more information on ChartKick you can check <a href="http://www.chartkick.com" target="_blank">Chartkick</a>.
</p>




<p>
  So far so good, That's it!!! See ya!!! :)
</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Automatically-updating Timeago Text with rails-livestamp Gem]]></title>
    <link href="http://geekhmer.github.io/blog/2015/05/02/automatically-updating-timeago-text-with-rails-livestamp-gem/"/>
    <updated>2015-05-02T08:29:00+07:00</updated>
    <id>http://geekhmer.github.io/blog/2015/05/02/automatically-updating-timeago-text-with-rails-livestamp-gem</id>
    <content type="html"><![CDATA[<p>
  <img src="http://geekhmer.github.io/images/rubygems_logo.png" width="200" alt="Automatically-updating Timeago Text with rails-livestamp Gem" />
</p>




<p>
  <a href="https://github.com/Bunlong/rails-livestamp" target="_blank">rails-livestamp</a> is a simple jQuery plugin that makes it easy to provides automatically updating text to your timestamped HTML elements.
</p>




<p>
  <strong>Installation</strong><br/>
  Add this line to your application's Gemfile:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Gemfile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">~&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">1</span><span class="o">.</span><span class="mi">3</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  And then execute:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bundle</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Or install it yourself as:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="n">install</span> <span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  To use rails-livestamp add this require statement to your application.js file:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>application.js </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="sr">//</span><span class="o">=</span> <span class="nb">require</span> <span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  <strong>Usage</strong><br/>
  No extra JavaScript required! Just use a <span> with the data-livestamp attribute set to the desired Unix timestamp (in seconds), like this:
</p>




<p>
  If you use ERB:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">You</span> <span class="n">discovered</span> <span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span> <span class="o">&lt;</span><span class="n">span</span> <span class="n">data</span><span class="o">-</span><span class="n">livestamp</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">#{</span><span class="no">Time</span><span class="o">.</span><span class="n">now</span><span class="o">.</span><span class="n">to_i</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">&gt;&lt;</span><span class="sr">/span&gt;.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  If you use HAML:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">You</span> <span class="n">discovered</span> <span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span>
</span><span class='line'><span class="o">%</span><span class="n">span</span><span class="p">{</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">data</span><span class="o">-</span><span class="n">livestamp</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span> <span class="o">=&gt;</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="c1">#{Time.now.to_i}&amp;rdquo;}.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  And you will see something like this:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">You</span> <span class="n">discovered</span> <span class="n">rails</span><span class="o">-</span><span class="n">livestamp</span> <span class="n">a</span> <span class="n">minutes</span> <span class="n">ago</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Wait half a minute - the livestamp will update automatically.
</p>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby on Rails Getting Started with JBuilder]]></title>
    <link href="http://geekhmer.github.io/blog/2015/04/29/ruby-on-rails-getting-started-with-jbuilder/"/>
    <updated>2015-04-29T20:20:00+07:00</updated>
    <id>http://geekhmer.github.io/blog/2015/04/29/ruby-on-rails-getting-started-with-jbuilder</id>
    <content type="html"><![CDATA[<p>
  <img src="http://geekhmer.github.io/images/ruby_on_rails.png" width="400" alt="Ruby on Rails Getting Started with JBuilder" />
</p>




<p>
  In the past, it could be really cumbersome to build proper JSON data feeds. Fortunately Ruby on Rails makes dealing with JSON much easier. Today we will learn how to use the JBuilder gem, which will allow us to easily build complex data feeds.
</p>




<p>
  First, we need to include the gem in our gemfile. Recent versions of Ruby on Rails include this gem commented out towards the bottom of the file. In addition, Rails 4 already includes this gem so you don't need to do anything. If it is in your gemfile and it is commented out, uncomment it, otherwise, add the gem using the line shown below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>Gemfile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">jbuilder</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">~&gt;</span> <span class="mi">1</span><span class="o">.</span><span class="mi">2</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Then run a bundle install:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">bundle</span> <span class="n">install</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Next, we will need a model and some sample data. In this sample project we will have 2 models. A product model, and a review model, which will be associated with products. Lets generate these 2 models now. Run the commands below to create the models and migrate the database:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Product</span> <span class="nb">name</span> <span class="ss">price</span><span class="p">:</span><span class="n">decimal</span><span class="p">{</span><span class="mi">12</span><span class="p">,</span><span class="mi">2</span><span class="p">}</span> <span class="ss">active</span><span class="p">:</span><span class="n">boolean</span>
</span><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Review</span> <span class="ss">product</span><span class="p">:</span><span class="n">references</span> <span class="n">user</span> <span class="ss">rating</span><span class="p">:</span><span class="n">integer</span> <span class="ss">body</span><span class="p">:</span><span class="n">text</span>
</span><span class='line'><span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">migrate</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Excellent, Now lets add some seed data. Copy and paste the following seed data into your seeds.rb file:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>db/seeds.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="no">Product</span><span class="o">.</span><span class="n">delete_all</span>
</span><span class='line'><span class="no">Review</span><span class="o">.</span><span class="n">delete_all</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;Product.create!([</span>
</span><span class='line'><span class="sr">  {id: 1, name: &amp;ldquo;Nintendo Wii U Premium&amp;rdquo;, price: 250, active: true},</span>
</span><span class='line'><span class="sr">  {id: 2, name: &amp;ldquo;XBox 360 250GB&amp;rdquo;, price: 250, active: true},</span>
</span><span class='line'><span class="sr">  {id: 3, name: &amp;ldquo;Playstation 3 500 GB&amp;rdquo;, price: 239.95, active: true},</span>
</span><span class='line'><span class="sr">  {id: 4, name: &amp;ldquo;Nintendo Wii&amp;rdquo;, price: 99.95, active: true},</span>
</span><span class='line'><span class="sr">  {id: 5, name: &amp;ldquo;Nintendo 3DS&amp;rdquo;, price: 174.95, active: true}</span>
</span><span class='line'><span class="sr">])&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span><span class="no">Review</span><span class="o">.</span><span class="n">create!</span><span class="p">(</span><span class="o">[</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Bob</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">dated</span> <span class="n">graphics</span><span class="o">.</span>  <span class="no">Overpriced</span><span class="o">.</span>  <span class="no">However</span><span class="p">,</span> <span class="n">the</span> <span class="n">games</span> <span class="n">are</span> <span class="n">awesome</span><span class="o">.</span><span class="n">&amp;rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Rich</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">MARIO</span><span class="o">!</span>  <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="n">nuff</span> <span class="no">Said</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">James</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Excellent</span> <span class="n">value</span> <span class="k">for</span> <span class="n">the</span> <span class="n">money</span><span class="o">.</span><span class="n">&amp;rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Alison</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Love</span> <span class="n">it!</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">James</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Bigger</span> <span class="n">hard</span> <span class="n">drive</span> <span class="k">then</span> <span class="n">my</span> <span class="no">XBox</span> <span class="mi">360</span><span class="o">.</span>  <span class="no">Weak</span> <span class="n">user</span> <span class="n">interface</span> <span class="n">though</span><span class="o">.</span><span class="n">&amp;rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Kay</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Extremely</span> <span class="n">dated</span><span class="o">.</span>  <span class="no">Don</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span><span class="n">t</span> <span class="n">buy</span><span class="o">.</span>  <span class="no">Will</span> <span class="n">be</span> <span class="n">discontinued</span> <span class="n">soon</span><span class="o">.</span><span class="n">&amp;rdquo</span><span class="p">;},</span>
</span><span class='line'>  <span class="p">{</span><span class="nb">id</span><span class="p">:</span> <span class="mi">7</span><span class="p">,</span> <span class="n">product_id</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="ss">user</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Jed</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="ss">rating</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="ss">body</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="no">Awesome</span> <span class="n">handheld</span> <span class="nb">system</span><span class="p">,</span> <span class="n">but</span> <span class="n">a</span> <span class="n">bit</span> <span class="n">overpriced</span><span class="o">.</span><span class="n">&amp;rdquo</span><span class="p">;}</span>
</span><span class='line'><span class="o">]</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Next, run the seed command to populate your database:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">seed</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Well, we now have a database populated with products and reviews. Next we will need to set up the association between our products and our reviews. First, open up the Product model and modify it so that it looks like the code listed below:
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/models/product.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Product</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:reviews</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Great, now lets add the reverse association. Open up your Review model and verify that it looks like the code listed below. Rails should auto populate this, but double check just to be sure.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/models/reviews.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Review</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">belongs_to</span> <span class="ss">:product</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  With the database model created, our data populated, and our associations set up, now it's time to create a controller. Run the command below to create products controller.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="n">products</span> <span class="n">index</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Now, lets make a change to our routes.rb file so that our controller becomes a resourceful controller. Replace the line that says get "products/index" with the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>config/routes.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;get &amp;ldquo;products/in</span><span class="n">dex</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;resources :products, only: [:index]</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  This sets up the products controller as a resourceful controller. Now, in order to create a json feed using jbuilder, we must create a jbuilder view. Create a new file in app/views/products called index.json.jbuilder and add the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/products/index.json.jbuilder </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">products</span> <span class="k">do</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Excellent. Now if you navigate to http://localhost:3000/products.json You will see an empty json data feed. Now, lets add some content to that data feed. Now, open up the products controller and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/controllers/products_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ProductsController</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;pre&gt;&lt;code&gt;@products = Product.all</span>
</span><span class='line'><span class="sr">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;</span><span class="sr">/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  end</span>
</span><span class='line'><span class="sr">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Next, Open the jbuilder file again and modify it so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/products/index.json.jbuilder </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">products</span> <span class="vi">@products</span> <span class="k">do</span> <span class="o">|</span><span class="n">product</span><span class="o">|</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">name</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">price</span> <span class="n">number_to_currency</span> <span class="n">product</span><span class="o">.</span><span class="n">price</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">active</span> <span class="n">product</span><span class="o">.</span><span class="n">active</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Excellent, now if we refresh the page we will see a listing of products in json format. Now lets add the reviews. Modify your code so that it looks like the code listed below.
</p>


<p><div class='bogus-wrapper'><notextile><figure class='code'><figcaption><span>app/views/products/index.json.jbuilder </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">products</span> <span class="vi">@products</span> <span class="k">do</span> <span class="o">|</span><span class="n">product</span><span class="o">|</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">name</span> <span class="n">product</span><span class="o">.</span><span class="n">name</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">price</span> <span class="n">number_to_currency</span> <span class="n">product</span><span class="o">.</span><span class="n">price</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">active</span> <span class="n">product</span><span class="o">.</span><span class="n">active</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;  json.reviews product.reviews do |review|&lt;/</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span><span class="n">json</span><span class="o">.</span><span class="n">user</span> <span class="n">review</span><span class="o">.</span><span class="n">user</span>
</span><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">rating</span> <span class="n">review</span><span class="o">.</span><span class="n">rating</span>
</span><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">body</span> <span class="n">review</span><span class="o">.</span><span class="n">body</span>
</span><span class='line'><span class="o">&lt;</span><span class="sr">/code&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure></notextile></div></p>

<p>
  Excellent! Now if we refresh the page we'll see the review listing for each product. That's it folks! That's all there is to using the jbuilder gem.
</p>




<p>
  So far so good, That's it!!! See ya!!! :)
</p>

]]></content>
  </entry>
  
</feed>
