
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>GeeKhmer</title>
  <meta name="author" content="Bunlong Van">
  
  
  <meta name="description" content="The biggest website of computer programming, Ruby, Ruby on Rails, Erlang, Chicagoboss and Javascript in Southeast Asia.">

  <meta name="keywords" content="geekhmer,khmer,cambodia,geek khmer,khmer geek,geek cambodia,cambodia geek,hacker,khmer hacker,hacker khmer,hacking,coding,programming,testing,Ruby,Ruby khmer,khmer Ruby,Rubyist,khmer Rubyist,Rubyist khmer,Rubyist cambodia,cambodia Rubyist,Ruby on Rails,Ruby on Rails khmer,khmer Ruby on Rails,Cambodia Ruby,Ruby Cambodia,Cambodia Ruby on Rails,Ruby on Rails Cambodia,RSpec TDD,RSpec BDD,facebook,computer general,networking,Chicagoboss,erlang,Erlang,Khmer Chicagoboss, Chicagoboss Khmer,Cambodia Chicagoboss,Chicagoboss Cambodia,Khmer Erlang,Erlang Khmer,Cambodia Erlang, Erlang Cambodia, Ruby southeast asia, Ruby on Rails southeast asia">

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://geekhmer.github.io/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="" rel="alternate" title="GeeKhmer" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

<link href="/stylesheets/jquery.fancybox.css" media="screen, projection" rel="stylesheet" type="text/css">
<script src="/javascripts/libs/jquery.fancybox.pack.js"></script>
<script src="/javascripts/init_fancybox.js"></script>

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1>
    <!-- <a href="/">GeeKhmer</a> -->
    <div class="logo" />
  </h1>
  
</hgroup>

</header>
  <nav role="navigation">
  <form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:geekhmer.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
  </form>

<ul class="subscription" data-subscription="rss">
  
  
</ul>
<ul class="main-navigation">
  <li><a href="/">Home</a></li>
  <li><a href="/blog/archives">Articles</a></li>
  <li><a href="/about">About</a></li>
  <li><a href="/team">Team</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/17/ruby-on-rails-export-csv/">Ruby on Rails Export CSV</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-17T22:25:00+07:00" pubdate data-updated="true">Apr 17<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Ruby on Rails Export CSV" />
</p>




<p>
  Sometime you will want to provide a CSV export option for your users. This article will show you how.
</p>




<p>
  The first thing we need to do is open up the config/application.rb file and add:
</p>




<figure class='code'><figcaption><span>config/application.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;csv&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Next, we need to add some code to the model that will export the data in the CSV format. Add the following code to the model you wish to export to CSV:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">as_csv</span>
</span><span class='line'>  <span class="no">CSV</span><span class="o">.</span><span class="n">generate</span> <span class="k">do</span> <span class="o">|</span><span class="n">csv</span><span class="o">|</span>
</span><span class='line'>    <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">column_names</span>
</span><span class='line'>    <span class="n">all</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">item</span><span class="o">|</span>
</span><span class='line'>      <span class="n">csv</span> <span class="o">&lt;&lt;</span> <span class="n">item</span><span class="o">.</span><span class="n">attributes</span><span class="o">.</span><span class="n">values_at</span><span class="p">(</span><span class="o">*</span><span class="n">column_names</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This code will export both the column headers as well as the data in the csv format and return the result.
</p>




<p>
  Finally, we need to add a bit of extra code to our controller in order to return the CSV data to our user. Assuming your model and controller are named posts, add the following code to your posts controller:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>  <span class="vi">@posts</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="ss">:created_at</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">html</span>
</span><span class='line'>    <span class="nb">format</span><span class="o">.</span><span class="n">csv</span> <span class="p">{</span> <span class="n">send_data</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">as_csv</span> <span class="p">}</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now, if you visit http://localhost:3000/posts.csv, you will be prompted to download the CSV.
</p>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/16/how-to-build-a-sitemap-for-your-ruby-on-rails-application/">How to Build a Sitemap for Your Ruby on Rails Application</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-16T21:40:00+07:00" pubdate data-updated="true">Apr 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="How to Build a Sitemap for Your Ruby on Rails Application" />
</p>




<p>
  Sitemaps are a valuable tool for telling search engines about the structure of your website. Creating a sitemap and submitting it to the search engines can let Google or Bing know about the pages they have missed when they crawled your site. In addition, submitting a sitemap can speed up crawl times significantly.
</p>




<p>
  In this article we will show you how to build your own sitemap which you can then submit to the various search engines.
</p>




<p>
  <strong>Rails Application Setup</strong><br/>
  We are going to build a very simple blog. First we will build the blog itself, then we will add the functionality needed for the sitemap. Don&#8217;t worry, this won&#8217;t take long.
</p>




<p>
  First let&#8217;s create our models. We only need one model for this example, Post. The Post model is simply an instance of a blog entry. Run the commands below to create the Post model now:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Post</span> <span class="n">title</span> <span class="ss">body</span><span class="p">:</span><span class="n">text</span>
</span><span class='line'><span class="n">rake</span> <span class="ss">db</span><span class="p">:</span><span class="n">migrate</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Great, now let&#8217;s create our controllers. In this example we will have two controllers. The Posts controller lists our posts and lets us view individual posts, and the Sitemap controller actually generates the sitemap. Run the commands below to create these controllers now:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="no">Posts</span> <span class="n">index</span> <span class="n">show</span>
</span><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">controller</span> <span class="no">Sitemap</span> <span class="n">index</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now let&#8217;s add our routes. Open up your routes file and modify it to look like the code listed below. Be sure not to overwrite line 1 of your routes file with line 1 of the example code listed:
</p>




<figure class='code'><figcaption><span>config/routes.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="ss">SitemapExample</span><span class="p">:</span><span class="ss">:Application</span><span class="o">.</span><span class="n">routes</span><span class="o">.</span><span class="n">draw</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">resources</span> <span class="ss">:posts</span><span class="p">,</span> <span class="ss">only</span><span class="p">:</span> <span class="o">[</span><span class="ss">:index</span><span class="p">,</span> <span class="ss">:show</span><span class="o">]</span>
</span><span class='line'>  <span class="n">resources</span> <span class="ss">:sitemap</span><span class="p">,</span> <span class="ss">only</span><span class="p">:</span> <span class="o">[</span><span class="ss">:index</span><span class="o">]</span>
</span><span class='line'>  <span class="n">root</span> <span class="ss">to</span><span class="p">:</span> <span class="s2">&quot;posts#index&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now let&#8217;s add code to our controllers. First let&#8217;s add the code necessary to list and display posts to the Posts controller. Open up your Posts controller and modify it so that it looks like the code listed below:
</p>




<figure class='code'><figcaption><span>app/controllers/posts_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PostsController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@posts</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;created_at DESC&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">show</span>
</span><span class='line'>    <span class="vi">@post</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:id</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now lets add code to our Sitemap controller. The only code we need here is code to list the posts. Open up your Sitemap controller and modify it so that it looks like the code listed below.
</p>




<figure class='code'><figcaption><span>app/controllers/sitemap_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">SitemapController</span> <span class="o">&lt;</span> <span class="no">ApplicationController</span>
</span><span class='line'>  <span class="n">respond_to</span> <span class="ss">:xml</span>
</span><span class='line'>  <span class="k">def</span> <span class="nf">index</span>
</span><span class='line'>    <span class="vi">@posts</span> <span class="o">=</span> <span class="no">Post</span><span class="o">.</span><span class="n">order</span><span class="p">(</span><span class="s2">&quot;created_at DESC&quot;</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now let&#8217;s create the views. First lets create the index view for the Posts controller. Open up the index view and modify it so that i looks like the code listed below.
</p>




<figure class='code'><figcaption><span>app/views/posts/index.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="no">My</span> <span class="no">Blog</span><span class="o">&lt;</span><span class="sr">/h1&gt;</span>
</span><span class='line'><span class="sr">&lt;%  @posts.each do |post| %&gt;</span>
</span><span class='line'><span class="sr">  &lt;h3&gt;&lt;%= link_to post.title, post %&gt;&lt;/</span><span class="n">h3</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="nb">p</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="sx">%= post.body.html_safe %&gt;</span>
</span><span class='line'><span class="sx">  &lt;/p&gt;</span>
</span><span class='line'><span class="sx">  &lt;% if post !=</span> <span class="vi">@posts</span><span class="o">.</span><span class="n">last</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">    &lt;hr /&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sx">% end %&gt;</span>
</span><span class='line'><span class="sx">&lt;% end %&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now let&#8217;s create the show view. Open up the show view for the Posts controller and modify it so that it looks like the code listed below.
</p>




<figure class='code'><figcaption><span>app/views/posts/show.html.erb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;&lt;</span><span class="sx">%= @post.title %&gt;&lt;/h1&gt;</span>
</span><span class='line'><span class="sx">&lt;p&gt;</span>
</span><span class='line'><span class="sx">  &lt;%=</span> <span class="vi">@post</span><span class="o">.</span><span class="n">body</span><span class="o">.</span><span class="n">html_safe</span> <span class="sx">%&gt;</span>
</span><span class='line'><span class="sx">&lt;/p&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Now it&#8217;s time for the sitemap. A sitemap is an XML file that typically consists of a number of url xml elements encapsulated by a urlset xml element. Each url typically has the 4 elements listed below.
</p>


<table>
<thead>
<tr>
<th>XML </th>
<th> Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>loc </td>
<td> The actual url to the page you wish to list in the sitemap.</td>
</tr>
<tr>
<td>changefreq </td>
<td> How often the page changes, can be always, hourly, daily, weekly, monthly, yearly, or never.</td>
</tr>
<tr>
<td>priority </td>
<td> How important the page is within the context of your site.</td>
</tr>
<tr>
<td>lastmod </td>
<td> The date of the last modification of this page.</td>
</tr>
</tbody>
</table>


<br/>




<p>
  An example sitemap is listed below:
</p>




<figure class='code'><figcaption><span>sitemap.xml </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">&lt;</span><span class="p">?</span><span class="n">xml</span> <span class="n">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span><span class="sc">?&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="n">urlset</span> <span class="n">xmlns</span><span class="o">=</span><span class="s2">&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">loc</span><span class="o">&gt;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="ss">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/&lt;</span><span class="sr">/loc&gt;</span>
</span><span class='line'><span class="sr">    &lt;changefreq&gt;hourly&lt;/</span><span class="n">changefreq</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">priority</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">.</span><span class="mi">0</span><span class="o">&lt;</span><span class="sr">/priority&gt;</span>
</span><span class='line'><span class="sr">  &lt;/u</span><span class="n">rl</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">loc</span><span class="o">&gt;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//</span><span class="ss">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">posts</span><span class="o">/</span><span class="mi">2</span><span class="o">&lt;</span><span class="sr">/loc&gt;</span>
</span><span class='line'><span class="sr">    &lt;changefreq&gt;daily&lt;/</span><span class="n">changefreq</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">priority</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">8</span><span class="o">&lt;</span><span class="sr">/priority&gt;</span>
</span><span class='line'><span class="sr">    &lt;lastmod&gt;2014-03-04T17:01:15.37+00:00&lt;/</span><span class="n">lastmod</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sr">/url&gt;</span>
</span><span class='line'><span class="sr">  &lt;url&gt;</span>
</span><span class='line'><span class="sr">    &lt;loc&gt;http:/</span><span class="o">/</span><span class="ss">localhost</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span><span class="n">posts</span><span class="o">/</span><span class="mi">1</span><span class="o">&lt;</span><span class="sr">/loc&gt;</span>
</span><span class='line'><span class="sr">    &lt;changefreq&gt;daily&lt;/</span><span class="n">changefreq</span><span class="o">&gt;</span>
</span><span class='line'>    <span class="o">&lt;</span><span class="n">priority</span><span class="o">&gt;</span><span class="mi">0</span><span class="o">.</span><span class="mi">8</span><span class="o">&lt;</span><span class="sr">/priority&gt;</span>
</span><span class='line'><span class="sr">    &lt;lastmod&gt;2014-03-04T17:01:15.36+00:00&lt;/</span><span class="n">lastmod</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="o">&lt;</span><span class="sr">/url&gt;</span>
</span><span class='line'><span class="sr">&lt;/u</span><span class="n">rlset</span><span class="o">&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This example was generated from our application. To do this yourself, create a new view for our Sitemaps controller called index.xml.builder and add in the code listed below.
</p>




<figure class='code'><figcaption><span>app/views/sitemap/index.xml.builder </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">xml</span><span class="o">.</span><span class="n">instruct!</span>
</span><span class='line'>
</span><span class='line'><span class="n">xml</span><span class="o">.</span><span class="n">urlset</span><span class="p">(</span><span class="ss">xmlns</span><span class="p">:</span> <span class="s2">&quot;http://www.sitemaps.org/schemas/sitemap/0.9&quot;</span><span class="p">)</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">xml</span><span class="o">.</span><span class="n">url</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">xml</span><span class="o">.</span><span class="n">loc</span> <span class="n">root_url</span>
</span><span class='line'>    <span class="n">xml</span><span class="o">.</span><span class="n">changefreq</span><span class="p">(</span><span class="s2">&quot;hourly&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="n">xml</span><span class="o">.</span><span class="n">priority</span> <span class="s2">&quot;1.0&quot;</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>  <span class="vi">@posts</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span>
</span><span class='line'>    <span class="n">xml</span><span class="o">.</span><span class="n">url</span> <span class="k">do</span>
</span><span class='line'>      <span class="n">xml</span><span class="o">.</span><span class="n">loc</span> <span class="n">post_url</span><span class="p">(</span><span class="n">post</span><span class="p">)</span>
</span><span class='line'>      <span class="n">xml</span><span class="o">.</span><span class="n">changefreq</span><span class="p">(</span><span class="s2">&quot;daily&quot;</span><span class="p">)</span>
</span><span class='line'>      <span class="n">xml</span><span class="o">.</span><span class="n">priority</span> <span class="s2">&quot;0.8&quot;</span>
</span><span class='line'>      <span class="n">xml</span><span class="o">.</span><span class="n">lastmod</span> <span class="n">post</span><span class="o">.</span><span class="n">updated_at</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y-%m-%dT%H:%M:%S.%2N%:z&quot;</span><span class="p">)</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  The first xml.url block adds an entry for our root url. In a more complex application we would probably want to add static entries for other pages. The next thing the code does is loop through each post and create a xml url element for each.
</p>




<p>
  You can preview your sitemap by starting your rails server and visiting http://localhost:3000/sitemap.xml.
</p>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/16/what-new-with-foreign-keys-in-rails-4-dot-2/">What New With Foreign Keys in Rails 4.2?</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-16T15:43:00+07:00" pubdate data-updated="true">Apr 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="What New with Foreign Keys in Rails 4.2?" />
</p>




<p>
  Previous versions of Rails did not have the ability to create foreign keys without resorting to executing SQL statements directly. This lead to messy, database dependent solutions that weren&#8217;t very nice. 
</p>




<p>
  Luckily, Rails 4.2 rectifies this with new features to add and remove foreign keys. In this article we will discuss what foreign keys are, and how to add them to your database.
</p>




<p>
  If you don&#8217;t know what a foreign key is, well, quite simply, a foreign key links one table to another&#8217;s primary key. For example, if I have an authors table and a books table, I could create a foreign key that points from books back to authors, linking the two tables together. Then, these two tables become linked. It means that I cannot add or update the record with invalid data for the author_id field in the books table.  I can also tell the database server what to do when I update or delete the record. For example, I can tell rails to automatically delete child records when the parent is deleted (delete an author from the authors table and all the author&#8217;s books are deleted). I could also tell Rails to set the author_id column to null or to simply not let me delete the author while child records exist.
</p>




<p>
  <strong>Add Foreign Keys</strong><br/>
  To add a foreign key to the books table:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:authors</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  We can also give the foreign key a custom name:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:authors</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="ss">:my_foreign_key</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  If we are using a non Rails friendly database, we can specify the column names we wish to use for the foreign key. For example, let&#8217;s say the primary key of the authors table is author_id and the key in the books table is auid. We could simply use the following code to create the foreign key:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:authors</span><span class="p">,</span> <span class="ss">column</span><span class="p">:</span> <span class="ss">:auid</span><span class="p">,</span> <span class="n">primary_key</span><span class="p">:</span> <span class="ss">:author_id</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  We can control the behavior of the foreign key as well. A list of the available behaviors are below. Independent behaviors can be set for both update as well as delete.<br/>
  - :restrict (default) - Prevents changes from being made.<br/>
  - :nullify - Sets the child columns to null.<br/>
  - :cascade - Cascades down to the child records. For instance, deleting an author deletes the author&#8217;s books.
</p>




<p>
  To specify behaviors, you simply use the <code>on_delete</code> or <code>on_update</code> parameters. For example, the following code would cascade deletes so that the books get deleted when the parent gets deleted.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">add_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:authors</span><span class="p">,</span> <span class="n">on_delete</span><span class="p">:</span> <span class="n">cascade</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Delete Foreign Keys</strong><br/>
  It is just as easy to delete foreign keys:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">remove_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">:authors</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  You can optionally specify the name of the foreign key to delete:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">remove_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="nb">name</span><span class="p">:</span> <span class="ss">:my_foreign_key</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  If you have non Rails friendly column names, you can specify the column name that contains the foreign key you wish to remove:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">remove_foreign_key</span> <span class="ss">:books</span><span class="p">,</span> <span class="ss">column</span><span class="p">:</span> <span class="ss">:auid</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/16/ruby-on-rails-filter-vs-action/">Ruby on Rails _filter vs _action</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-16T09:13:00+07:00" pubdate data-updated="true">Apr 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Ruby on Rails _filter vs _action" />
</p>




<p>
  If you are coming to Rails 4 from earlier versions of Rails, you may have noticed the new <code>_action</code> methods floating around.
</p>




<p>
  Seeing these for the first time may have left you scratching your head a bit and asking &#8220;Aren&#8217;t these the same as the <code>_filter</code> functions in previous versions of Rails?&#8221; The answer is a resounding YES. For Rails 4.x, the rails team decided to rename the functions to better describe what they are doing. Don&#8217;t worry, the old functions still work. However it is recommended that you use the new syntax going forward, as the <code>_filter</code> functions may be deprecated in the future.
</p>




<p>
  Below shows a list of the old and new functions:
</p>


<table>
<thead>
<tr>
<th>Old Function </th>
<th> New Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>before_filter </td>
<td> Abefore_action</td>
</tr>
<tr>
<td>after_filter </td>
<td> after_action</td>
</tr>
<tr>
<td>around_filter </td>
<td> around_action</td>
</tr>
<tr>
<td>append_after_filter </td>
<td> append_after_action</td>
</tr>
<tr>
<td>append_around_filter </td>
<td> append_around_actionor DOM classes.</td>
</tr>
<tr>
<td>prepend_around_filter </td>
<td> prepend_around_action</td>
</tr>
<tr>
<td>append_before_filter </td>
<td> append_before_action</td>
</tr>
<tr>
<td>skip_before_filter </td>
<td> skip_before_action</td>
</tr>
<tr>
<td>skip_around_filter </td>
<td> skip_around_action</td>
</tr>
<tr>
<td>skip_after_filter </td>
<td> skip_after_action</td>
</tr>
<tr>
<td>skip_filter </td>
<td> skip_action_callback</td>
</tr>
</tbody>
</table>


<br/>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/16/quickly-add-bootstrap-to-your-project/">Quickly Add Bootstrap to Your Project</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-16T08:52:00+07:00" pubdate data-updated="true">Apr 16<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/bootstrap.png" alt="Quickly Add Bootstrap to Your Project" />
</p>




<p>
  Bootstrap is an amazing layout library that is awesome for building both prototypes as well as full blown websites. This very website makes extensive use of Bootstrap 3 to make things look awesome on both mobiles sites as well as the desktop.
</p>




<p>
  What if we want to quickly prototype out a site using bootstrap? Fortunately you can easily add bootstrap to your site without downloading anything, simply reference the associated files on the Yandex CDN. 
</p>




<p>
  Yandex is a worldwide search engine that is extremely popular in russia. Their CDN is extremely fast and has many different libraries available. To add bootstrap via yandex, simply include them like so (this also include jQuery, since Bootstrap JS requires it).
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://yandex.st/jquery/1.11.1/jquery.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">link</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;http://yandex.st/bootstrap/3.1.1/css/bootstrap.min.css&quot;</span> <span class="nx">media</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span> <span class="nx">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span> <span class="o">/&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://yandex.st/bootstrap/3.1.1/js/bootstrap.min.js&quot;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  A full list of the libraries available can be found on the <a href="https://tech.yandex.ru/jslibs/" target="_blank">yandex</a> website. Note that it&#8217;s in russian, so you might need to translate it.
</p>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/15/respond-with-json-in-ruby-on-rails-application/">Respond With JSON in Ruby on Rails Application</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-15T15:06:00+07:00" pubdate data-updated="true">Apr 15<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Translate Your Ruby on Rails Application" />
</p>




<p>
  When building a RESTful API in Rails application, there are many different options and gems you can use to format your JSON responses. This isn&#8217;t a post about how to build an API, but rather about some of the different popular options on how to define and structure JSON.
</p>




<p>
  <strong>RABL</strong><br/>
  <a href="http://www.leighhalliday.com/responding-with-json-in-rails" target="_blank">RABL</a> is a DSL for generating both JSON and XML. In my mind it has a similar feel to Jbuilder, which I&#8217;ll discuss below. It&#8217;s works by creating a view with the extension .rabl, and defining which attributes, nodes, and relations you wish to include in the JSON response.
</p>




<p>
  Here&#8217;s an example:
</p>




<figure class='code'><figcaption><span>app/views/posts/index.rabl </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">collection</span> <span class="vi">@posts</span>
</span><span class='line'><span class="n">attributes</span> <span class="ss">:id</span><span class="p">,</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:subject</span>
</span><span class='line'><span class="n">child</span><span class="p">(</span><span class="ss">:user</span><span class="p">)</span> <span class="p">{</span> <span class="n">attributes</span> <span class="ss">:full_name</span> <span class="p">}</span>
</span><span class='line'><span class="n">node</span><span class="p">(</span><span class="ss">:read</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span> <span class="n">post</span><span class="o">.</span><span class="n">read_by?</span><span class="p">(</span><span class="vi">@user</span><span class="p">)</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Active Model Serializer</strong><br/>
  <a href="https://github.com/rails-api/active_model_serializers" target="_blank">Active Model Serializer</a> is a great way to build JSON responses using an object oriented approach. The objects have a very similar feel to how your ActiveModel object is set up in terms of attributes and relationships. It also allows you to choose your adapter-to decide what type of JSON structure is produced-or to build your own. Popular supported formats are JSON-API and JSON-HAL.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">PostSerializer</span> <span class="o">&lt;</span> <span class="ss">ActiveModel</span><span class="p">:</span><span class="ss">:Serializer</span>
</span><span class='line'>  <span class="n">attributes</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:body</span>
</span><span class='line'>  <span class="n">has_many</span> <span class="ss">:comments</span>
</span><span class='line'>  <span class="n">url</span> <span class="ss">:post</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Jbuilder</strong><br/>
  <a href="https://github.com/rails/jbuilder" target="_blank">jbuilder</a> provides a very similar DSL to RABL. Jbuilder is included with Rails, so it is used quite a bit. Rails Casts has a free episode which goes into greater detail about Jbuilder. It&#8217;s very easy to use and provides a lot of flexibility in defining exactly what attributes are included in and how the response is formatted and nested.
</p>




<figure class='code'><figcaption><span>app/views/message/show.json.jbuilder </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">content</span> <span class="n">format_content</span><span class="p">(</span><span class="vi">@message</span><span class="o">.</span><span class="n">content</span><span class="p">)</span>
</span><span class='line'><span class="n">json</span><span class="o">.</span><span class="p">(</span><span class="vi">@message</span><span class="p">,</span> <span class="ss">:created_at</span><span class="p">,</span> <span class="ss">:updated_at</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">json</span><span class="o">.</span><span class="n">author</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">name</span> <span class="vi">@message</span><span class="o">.</span><span class="n">creator</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">familiar</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">email_address</span> <span class="vi">@message</span><span class="o">.</span><span class="n">creator</span><span class="o">.</span><span class="n">email_address_with_name</span>
</span><span class='line'>  <span class="n">json</span><span class="o">.</span><span class="n">url</span> <span class="n">url_for</span><span class="p">(</span><span class="vi">@message</span><span class="o">.</span><span class="n">creator</span><span class="p">,</span> <span class="nb">format</span><span class="p">:</span> <span class="ss">:json</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Grape Entity</strong><br/>
  <a href="https://github.com/intridea/grape-entity" target="_blank">Grape Entity</a> was extracted from Grape, which is a popular gem used for building RESTful APIs. Similarly to RABL and Jbuilder, it provides a DSL for defining entities which are the structure of your JSON response.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">API</span>
</span><span class='line'>  <span class="k">module</span> <span class="nn">Entities</span>
</span><span class='line'>    <span class="k">class</span> <span class="nc">Status</span> <span class="o">&lt;</span> <span class="ss">Grape</span><span class="p">:</span><span class="ss">:Entity</span>
</span><span class='line'>      <span class="n">expose</span> <span class="ss">:user_name</span>
</span><span class='line'>      <span class="n">expose</span> <span class="ss">:text</span><span class="p">,</span> <span class="ss">documentation</span><span class="p">:</span> <span class="p">{</span> <span class="ss">type</span><span class="p">:</span> <span class="s2">&quot;String&quot;</span><span class="p">,</span> <span class="ss">desc</span><span class="p">:</span> <span class="s2">&quot;Status update text.&quot;</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">expose</span> <span class="ss">:ip</span><span class="p">,</span> <span class="k">if</span><span class="p">:</span> <span class="p">{</span> <span class="ss">type</span><span class="p">:</span> <span class="ss">:full</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">expose</span> <span class="ss">:user_type</span><span class="p">,</span> <span class="ss">:user_id</span><span class="p">,</span> <span class="k">if</span><span class="p">:</span> <span class="nb">lambda</span> <span class="p">{</span> <span class="o">|</span><span class="n">status</span><span class="p">,</span> <span class="n">options</span><span class="o">|</span> <span class="n">status</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">public?</span> <span class="p">}</span>
</span><span class='line'>      <span class="n">expose</span> <span class="ss">:contact_info</span> <span class="k">do</span>
</span><span class='line'>        <span class="n">expose</span> <span class="ss">:phone</span>
</span><span class='line'>        <span class="n">expose</span> <span class="ss">:address</span><span class="p">,</span> <span class="ss">using</span><span class="p">:</span> <span class="ss">API</span><span class="p">:</span><span class="ss">:Address</span>
</span><span class='line'>      <span class="k">end</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>ROAR</strong><br/>
  <a href="https://github.com/apotonick/roar" target="_blank">ROAR</a> allows you to build presenter classes to represent your data. It comes with support for JSON, JSON-HAL, JSON-API, and XML.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;roar/json&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">module</span> <span class="nn">SongRepresenter</span>
</span><span class='line'>  <span class="kp">include</span> <span class="ss">Roar</span><span class="p">:</span><span class="ss">:JSON</span>
</span><span class='line'>  <span class="n">property</span> <span class="ss">:title</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>ActiveModel or Hash</strong><br/>
  This may seem like a strange thing to point out, but for very simple cases, you can simply call the to_json method on either an ActiveModel object or a native Ruby Hash.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Using an @organization model</span>
</span><span class='line'><span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="vi">@organization</span><span class="o">.</span><span class="n">to_json</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># Using a plain Ruby Hash</span>
</span><span class='line'><span class="n">respond_to</span> <span class="k">do</span> <span class="o">|</span><span class="nb">format</span><span class="o">|</span>
</span><span class='line'>  <span class="nb">format</span><span class="o">.</span><span class="n">json</span> <span class="k">do</span>
</span><span class='line'>    <span class="n">render</span> <span class="ss">json</span><span class="p">:</span> <span class="p">{</span>
</span><span class='line'>      <span class="nb">name</span><span class="p">:</span> <span class="vi">@user</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
</span><span class='line'>      <span class="ss">email</span><span class="p">:</span> <span class="vi">@user</span><span class="o">.</span><span class="n">email</span>
</span><span class='line'>    <span class="p">}</span><span class="o">.</span><span class="n">to_json</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/15/create-qr-codes-in-ruby-on-rails-application/">Create QR Codes in Ruby on Rails Application</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-15T11:34:00+07:00" pubdate data-updated="true">Apr 15<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Create QR Codes in Ruby on Rails Application" />
</p>




<p>
  <a href="https://rubygems.org/gems/barby" target="_blank">Barby</a> is a great gem for generating a barcode or QR code. You can choose to output it as any number of barcode types or as a QR code. This example will use a QR code but I have successfully used the Code128 barcode which is fairly common in the retail space.
</p>




<p>
  Add Barby to your gem file:
</p>




<figure class='code'><figcaption><span>Gemfile </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">gem</span> <span class="s1">&#39;barby&#39;</span><span class="p">,</span>  <span class="s1">&#39;~&gt; 0.6.2&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;rqrcode&#39;</span><span class="p">,</span><span class="s1">&#39;~&gt; 0.4.2&#39;</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Here is an example helper for generating the QR code as base64 encoded png data:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">generate_qr</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;barby&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;barby/barcode&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;barby/barcode/qr_code&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;barby/outputter/png_outputter&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">barcode</span> <span class="o">=</span> <span class="ss">Barby</span><span class="p">:</span><span class="ss">:QrCode</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="ss">level</span><span class="p">:</span> <span class="ss">:q</span><span class="p">,</span> <span class="ss">size</span><span class="p">:</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'>  <span class="n">base64_output</span> <span class="o">=</span> <span class="no">Base64</span><span class="o">.</span><span class="n">encode64</span><span class="p">(</span><span class="n">barcode</span><span class="o">.</span><span class="n">to_png</span><span class="p">({</span> <span class="ss">xdim</span><span class="p">:</span> <span class="mi">5</span> <span class="p">}))</span>
</span><span class='line'>  <span class="s2">&quot;data:image/png;base64,</span><span class="si">#{</span><span class="n">base64_output</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  And an example call from your view:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="o">%</span><span class="n">img</span><span class="p">{</span><span class="ss">src</span><span class="p">:</span> <span class="n">generate_qr</span><span class="p">(</span><span class="s2">&quot;http://geekhmer.github.io/&quot;</span><span class="p">),</span> <span class="ss">class</span><span class="p">:</span> <span class="s2">&quot;qr-code&quot;</span><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/15/translate-your-ruby-on-rails-application/">Translate Your Ruby on Rails Application</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-15T08:58:00+07:00" pubdate data-updated="true">Apr 15<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Translate Your Ruby on Rails Application" />
</p>




<p>
  If you&#8217;re planning to take over the world, you&#8217;ll need to convince everyone to speak your language, or better yet, why don&#8217;t you offer them a website that speaks their language. The goal is to have a website available in multiple languages, and for the visitors to be able to toggle over to the language they are most comfortable with.
</p>




<p>
  <strong>Routing</strong><br/>
  I like to nest all of my routes inside of a :locale scope. I also limit the locale options to a set that I have predefined in an initializer. You could also choose to deal with locale validity later on in the flow (before_action method), but it is up to you.
</p>




<figure class='code'><figcaption><span>config/routes.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">scope</span> <span class="s2">&quot;(:locale)&quot;</span><span class="p">,</span> <span class="ss">locale</span><span class="p">:</span> <span class="sr">/</span><span class="si">#{</span><span class="ss">MySite</span><span class="p">:</span><span class="ss">:ROUTE_LOCALES</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;|&quot;</span><span class="p">)</span><span class="si">}</span><span class="sr">/</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">root</span> <span class="ss">:to</span> <span class="o">=&gt;</span> <span class="s1">&#39;home#index&#39;</span>
</span><span class='line'>  <span class="n">resources</span> <span class="ss">:pages</span>
</span><span class='line'>  <span class="c1"># etc...</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><figcaption><span>onfig/initializers/my_site.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">module</span> <span class="nn">MySite</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="ss">MySite</span><span class="p">:</span><span class="ss">:LOCALES</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="ss">en</span><span class="p">:</span>    <span class="s2">&quot;English&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">kh</span><span class="p">:</span>    <span class="s2">&quot;Khmer&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="ss">fr</span><span class="p">:</span>    <span class="s2">&quot;French&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="n">en_us</span><span class="p">:</span> <span class="s2">&quot;US English&quot;</span><span class="p">,</span>
</span><span class='line'>  <span class="n">en_uk</span><span class="p">:</span> <span class="s2">&quot;UK English&quot;</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="ss">MySite</span><span class="p">:</span><span class="ss">:ROUTE_LOCALES</span> <span class="o">=</span> <span class="ss">MySite</span><span class="p">:</span><span class="ss">:LOCALES</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">each_with_object</span><span class="p">({})</span> <span class="k">do</span> <span class="o">|</span><span class="n">locale</span><span class="p">,</span> <span class="n">hsh</span><span class="o">|</span>
</span><span class='line'>  <span class="n">hsh</span><span class="o">[</span><span class="n">locale</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;_&quot;</span><span class="p">,</span><span class="s2">&quot;-&quot;</span><span class="p">)</span><span class="o">]</span> <span class="o">=</span> <span class="n">locale</span> <span class="k">if</span> <span class="n">locale</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">length</span> <span class="o">&gt;</span> <span class="mi">2</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This line of code will make sure all of your routes have the current locale in them.
</p>




<figure class='code'><figcaption><span>app/controllers/application_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">def</span> <span class="nf">default_url_options</span><span class="p">(</span><span class="n">options</span><span class="o">=</span><span class="p">{})</span>
</span><span class='line'>  <span class="p">{</span> <span class="ss">locale</span><span class="p">:</span> <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span> <span class="p">}</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Determining Locale</strong><br/>
  I usually have a before_action filter which does its best to determine the URL of the application. You might have other things in here too if you keep track of the preferred locale in a cookie, or if it is attached to the user&#8217;s session data or account. You may also want to use the HTTP_ACCEPT_LANGUAGE to determine if there is a match.
</p>




<figure class='code'><figcaption><span>app/controllers/application_controller.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">ApplicationController</span> <span class="o">&lt;</span> <span class="ss">ActionController</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">before_action</span> <span class="ss">:determine_locale</span>
</span><span class='line'>
</span><span class='line'>  <span class="kp">protected</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">determine_locale</span>
</span><span class='line'>    <span class="n">locale</span> <span class="o">=</span> <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="ss">:new_locale</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="ss">MySite</span><span class="p">:</span><span class="ss">:ROUTE_LOCALES</span><span class="o">.</span><span class="n">keys</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="n">params</span><span class="o">[</span><span class="ss">:new_locale</span><span class="o">]</span><span class="p">)</span>
</span><span class='line'>      <span class="n">params</span><span class="o">[</span><span class="ss">:new_locale</span><span class="o">]</span>
</span><span class='line'>    <span class="k">elsif</span> <span class="n">params</span><span class="o">.</span><span class="n">include?</span><span class="p">(</span><span class="ss">:locale</span><span class="p">)</span>
</span><span class='line'>      <span class="n">params</span><span class="o">[</span><span class="ss">:locale</span><span class="o">]</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>      <span class="n">locale_from_url</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">||</span> <span class="no">I18n</span><span class="o">.</span><span class="n">default_locale</span>
</span><span class='line'>    <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>    <span class="n">set_locale</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">locale_from_url</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
</span><span class='line'>    <span class="c1"># ... determine locale from host if you have different domains</span>
</span><span class='line'>    <span class="c1"># for different locales</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">def</span> <span class="nf">set_locale</span><span class="p">(</span><span class="n">locale</span><span class="p">)</span>
</span><span class='line'>    <span class="no">I18n</span><span class="o">.</span><span class="n">locale</span> <span class="o">=</span> <span class="n">locale</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="s2">&quot;-&quot;</span><span class="p">,</span><span class="s2">&quot;_&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_sym</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Static Text</strong><br/>
  The developers should be entering their keys into the yml files located in the locales folder if your rails application. I normally only have one for English, and then use other I18n backends (Redis for example) serve up the other translations. If the translations are in Redis, you will obviously need code that puts them there. I am working on an engine for this called <a href="https://github.com/leighhalliday/idioma" target="_blank">Idioma</a> which persists the translations using ActiveRecord and also to Redis at the same time.
</p>




<p>
  <strong>Dynamic Content</strong><br/>
  Because I18n comes built in to Rails, you won&#8217;t need to install many gems. But for dynamic content I recommend <a href="https://github.com/globalize/globalize" target="_blank">Globalize</a>. Along with this one is a handy gem called <a href="https://rubygems.org/gems/globalize-accessors" target="_blank">Globalize Accessors</a> which will help you when creating forms to enter this data in.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Page</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'>  <span class="n">translates</span> <span class="ss">:title</span><span class="p">,</span> <span class="ss">:body</span><span class="p">,</span> <span class="n">fallbacks_for_empty_translations</span><span class="p">:</span> <span class="kp">true</span>
</span><span class='line'>  <span class="n">globalize_accessors</span> <span class="ss">locales</span><span class="p">:</span> <span class="ss">MySite</span><span class="p">:</span><span class="ss">:LOCALES</span><span class="o">.</span><span class="n">keys</span><span class="p">,</span> <span class="ss">attributes</span><span class="p">:</span> <span class="o">[</span><span class="ss">:title</span><span class="p">,</span> <span class="ss">:body</span><span class="o">]</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Dynamic Content</strong><br/>
  One thing I set up are fallbacks&#8230; this is so you can translate English once, and only when there is a locale that differs from the default do you need to specifically translate it for that locale. Example, in the US colour is spelled like color.
</p>




<figure class='code'><figcaption><span>config/application.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">default_locale</span> <span class="o">=</span> <span class="ss">:en_ca</span>
</span><span class='line'><span class="n">config</span><span class="o">.</span><span class="n">i18n</span><span class="o">.</span><span class="n">fallbacks</span> <span class="o">=</span> <span class="p">{</span>
</span><span class='line'>  <span class="n">en_us</span><span class="p">:</span> <span class="ss">:en</span><span class="p">,</span>
</span><span class='line'>  <span class="n">kh</span>   <span class="p">:</span> <span class="ss">:kh</span><span class="p">,</span>
</span><span class='line'>  <span class="n">en_uk</span><span class="p">:</span> <span class="ss">:en</span><span class="p">,</span>
</span><span class='line'>  <span class="n">fr_lu</span><span class="p">:</span> <span class="ss">:fr</span><span class="p">,</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Having Your Website Translated</strong><br/>
  Because the translation team probably isn&#8217;t the same as the dev team, and they probably don&#8217;t have access to your code repository nor know how to edit yml files, you will want to have another way of giving them access to the translations. There is an established tool called <a href="https://github.com/tolk/tolk" target="_blank">Tolk</a>.
</p>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/13/ruby-on-rails-model-generator-useful-shortcuts/">Ruby on Rails Model Generator Useful Shortcuts</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-13T13:11:00+07:00" pubdate data-updated="true">Apr 13<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Ruby on Rails Renaming a Database Column" />
</p>




<p>
  <code>rails generate</code> command provides a lot of useful functionality, however some of it may not be immediately known to you as a developer. In this article we will explore a number of useful shortcuts available in the rails model generator.
</p>




<h3>Basics</h3>




<p>
  Let&#8217;s start with the basic command line usage.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">User</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <code>rails g</code> is the same thing as rails generate. Both commands do the same thing. We will use this shortcut throughout this article.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Product</span> <span class="nb">name</span> <span class="ss">quantity</span><span class="p">:</span><span class="n">integer</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This command generates a model named product with 2 fields, name, which is a string, and quantity, which is an integer. By not specifying the type for name, rails defaults to using string. Below is a complete list of types that you can use with the modal generator.
</p>




<p>
  <strong>Field Type Lists</strong><br/>
  - integer<br/>
  - primary_key<br/>
  - decimal<br/>
  - float<br/>
  - boolean<br/>
  - binary<br/>
  - string<br/>
  - text<br/>
  - date<br/>
  - time<br/>
  - datetime<br/>
  - timestamp
</p>




<p>
  You can also specify the size of a field as seen below.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Client</span> <span class="nb">name</span><span class="ss">:string</span><span class="p">{</span> <span class="mi">100</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This will create a name field with a limit of 100 characters. For the decimal type, you can specify a precision and scale value as well.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Product</span> <span class="nb">name</span> <span class="ss">price</span><span class="p">:</span><span class="n">decimal</span><span class="p">{</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">2</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Namespaced Models</strong><br/>
  You can create namespaced models as well. This is useful for example, in creating a special set of administrative users that are separate from your regular users. Running the command below will place the user model in the Admin namespace, which will have a prefixed table name of admin_ in the database.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="n">admin</span><span class="o">/</span><span class="n">user</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  As you can see from the code listed below, the user belongs to the admin namespace like mentioned earlier.
</p>




<figure class='code'><figcaption><span>app/models/admin/user.rb </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="k">class</span> <span class="nc">Admin</span><span class="o">::</span><span class="no">User</span> <span class="o">&lt;</span> <span class="ss">ActiveRecord</span><span class="p">:</span><span class="ss">:Base</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  <strong>Adding an Index</strong><br/>
  You can also add a database index right from the command line.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Site</span> <span class="nb">name</span><span class="ss">:string:index</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  In addition, you can make the index unique.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">Client</span> <span class="nb">name</span><span class="ss">:string:uniq</span>
</span></code></pre></td></tr></table></div></figure>




<h3>Model Relationships</h3>




<p>
  You can specify a basic relationship between models.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="no">User</span> <span class="ss">client</span><span class="p">:</span><span class="n">references</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This will create a user with a column named client_id, add an index, and automatically add a belongs_to relationship to the User model.
</p>




<p>
  You can also make the relationship polymorphic.
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">model</span> <span class="n">picture</span> <span class="ss">imageable</span><span class="p">:</span><span class="n">references</span><span class="p">{</span> <span class="n">polymorphic</span> <span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  This will set up a polymorphic relationship for pictures. Polymorphic relationships allow you to &#8216;share&#8217; a table between many different models. For instance, Products and People can both have pictures.
</p>




<p>
  The rails model generator exposes a lot of useful functionality that can save time if used properly. Thanks for reading!
</p>

</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2015/04/13/ruby-on-rails-renaming-a-database-column/">Ruby on Rails Renaming a Database Column</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-04-13T13:01:00+07:00" pubdate data-updated="true">Apr 13<span>th</span>, 2015</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>
  <img src="/images/ruby_on_rails.png" width="400" alt="Ruby on Rails Renaming a Database Column" />
</p>




<p>
  To rename a database column, first you need to create a migration:
</p>




<p>
  Terminal commands line:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rails</span> <span class="n">g</span> <span class="n">migration</span> <span class="no">RenameColumnXinTableYtoZ</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Next you need to edit the migration and add the following line:
</p>




<figure class='code'> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">rename_column</span> <span class="ss">:table</span><span class="p">,</span> <span class="ss">:old_column</span><span class="p">,</span> <span class="ss">:new_column</span>
</span></code></pre></td></tr></table></div></figure>




<p>
  Finally, please run a <code>rake db:migrate</code> and you are all set.
</p>




<p>
  So far so good, That&#8217;s it!!! See ya!!! :)
</p>

</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/5/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/06/03/my-development-stack/">My Development Stack</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/24/best-practices-for-agile-ruby-on-rails-development/">Best Practices for Agile Ruby on Rails Development</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/22/main-advantages-of-ruby-on-rails-usage/">Main Advantages of Ruby on Rails Usage</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/21/top-8-ruby-on-rails-websites/">Top 8 Ruby on Rails Websites</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/20/how-technology-company-make-money/">How Technology Company Make Money?</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/19/5-tips-to-scale-your-ruby-on-rails-application/">5 Tips to Scale Your Ruby on Rails Application</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/16/ip-geolocation-in-ruby-on-rails-application/">IP Geolocation in Ruby on Rails Application</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Category</h1>
  <ul id="recent_posts">
    
      <li>
        <a href="/blog/categories/facebook/">Facebook [ 4 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/ruby/">Ruby [ 93 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/heroku/">Heroku [ 2 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/ruby-on-rails/">Ruby on rails [ 86 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/testing/">Testing [ 5 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/layout/">Layout [ 3 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/ruby-metaprogramming/">Ruby metaprogramming [ 4 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/websocket/">Websocket [ 2 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/front-end-mvc-framework/">Front-end mvc framework [ 1 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/javascript/">Javascript [ 4 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/erlang/">Erlang [ 20 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/design-pattern/">Design pattern [ 1 ]</a>
      </li>
    
      <li>
        <a href="/blog/categories/other/">Other [ 22 ]</a>
      </li>
    
  </ul>
</section><section>
  <h1>Notes</h1>
  <ul id="recent_posts">
    <li>
      <a href="http://vimcommands.github.io/" target="_blank">Vim Commands</a>
    </li>
    <li>
      <a href="http://ruby-hacking-style-guide.github.io/" target="_blank">Ruby Hacking Style Guide</a>
    </li>
  </ul>
</section><section>
  <h1>References</h1>
  <ul id="recent_posts">
    <li>
      <a href="http://www.erlang.org/" target="_blank">
        <img src="/images/logo_erlang.png" />
      </a>
    </li>
    <li>
      <a href="http://www.chicagoboss.org/" target="_blank">
        <img src="/images/logo_chicagoboss.svg" />
      </a>
    </li>
    <li>
      <a href="https://www.ruby-lang.org/en/" target="_blank">
        <img src="/images/logo_ruby.png" />
      </a>
    </li>
    <li>
      <a href="http://guides.rubyonrails.org" target="_blank">
        <img src="/images/logo_rails_guides.png" />
      </a>
    </li>
    <li>
      <a href="http://railscasts.com" target="_blank">
        <img src="/images/logo_rails_casts.png" />
      </a>
    </li>
    <li>
      <a href="https://github.com" target="_blank">
        <img src="/images/logo_github.png" />
      </a>
    </li>
    <li>
      <a href="https://www.linode.com" target="_blank">
        <img src="/images/logo_linode.png" />
      </a>
    </li>
    <li>
      <a href="http://newrelic.com" target="_blank">
        <img src="/images/logo_newrelic.png" />
      </a>
    </li>
    <li>
      <a href="https://developers.facebook.com/" target="_blank">
        <img src="/images/logo_facebook.png" />
      </a>
    </li>
  </ul>
</section>




  
</aside>
    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 GeeKhmer in Phnom Penh, Cambodia.
</p>

</footer>
  



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=1451301955117043&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
